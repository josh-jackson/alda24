<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Longitudinal 2024 - bends</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">bends</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="trajectories-that-bend" class="slide level2">
<h2>Trajectories that bend</h2>
<ul>
<li><p>Thus far we have been sticking with monotonically increasing trajectories. This is a good assumption given the amount of data often found, along with the simplicity.</p></li>
<li><p>Often we want to see if trajectories are not straight. Development is not simple so our lines should not be.</p></li>
<li><p>Need effective strategies for line that bend that also balance tradeoffs with interpretability and overfitting</p></li>
</ul>
</section>
<section id="polynomial-and-splines" class="slide level2">
<h2>Polynomial and Splines</h2>
<p>Polynomials (quadratic) level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}(Time_{ij} - \bar{X)} + \beta_{2j}(Time_{ij} - \bar{X)}^2 + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} +   U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} +  U_{1j}\]</span> <span class="math display">\[{\beta}_{2j} = \gamma_{20} +  U_{2j}\]</span></p>
</section>
<section id="mlm-poly-example" class="slide level2">
<h2>MLM poly example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>personality <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2022/main/Subject_personality.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">ggplot</span>(personality,</span>
<span id="cb1-4"><a href="#cb1-4"></a>   <span class="fu">aes</span>(<span class="at">x =</span> neodate, <span class="at">y =</span> neuroticism, <span class="at">group =</span> mapid)) <span class="sc">+</span> <span class="fu">geom_line</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>personality<span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">group_by</span>(mapid) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">arrange</span>(neodate) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">seq_len</span>(<span class="fu">n</span>())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">ggplot</span>(personality,</span>
<span id="cb3-2"><a href="#cb3-2"></a>   <span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> neuroticism, <span class="at">group =</span> mapid)) <span class="sc">+</span> <span class="fu">geom_line</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>personality<span class="sc">$</span>neodate <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(personality<span class="sc">$</span>neodate, <span class="at">origin =</span> <span class="st">"1900-01-01"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">ggplot</span>(personality,</span>
<span id="cb4-4"><a href="#cb4-4"></a>   <span class="fu">aes</span>(<span class="at">x =</span> neodate, <span class="at">y =</span> neuroticism, <span class="at">group =</span> mapid)) <span class="sc">+</span> <span class="fu">geom_line</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># yes this code could be done more efficiently</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>personality.wide <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mapid, wave, neodate) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">spread</span>(wave, neodate) </span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>personality.wide<span class="sc">$</span>wave_1 <span class="ot">&lt;-</span> personality.wide<span class="sc">$</span><span class="st">'1'</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>personality.wide<span class="sc">$</span>wave_2 <span class="ot">&lt;-</span> personality.wide<span class="sc">$</span><span class="st">'2'</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>personality.wide<span class="sc">$</span>wave_3 <span class="ot">&lt;-</span> personality.wide<span class="sc">$</span><span class="st">'3'</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>personality.wide<span class="sc">$</span>wave_4 <span class="ot">&lt;-</span> personality.wide<span class="sc">$</span><span class="st">'4'</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>personality.wide<span class="sc">$</span>wave_5 <span class="ot">&lt;-</span> personality.wide<span class="sc">$</span><span class="st">'5'</span></span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a>personality.wide <span class="ot">&lt;-</span> personality.wide <span class="sc">%&gt;%</span> </span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="fu">mutate</span> (<span class="at">w_1 =</span> (wave_1 <span class="sc">-</span> wave_1)<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>          <span class="at">w_2 =</span> (wave_2 <span class="sc">-</span> wave_1)<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb5-15"><a href="#cb5-15"></a>          <span class="at">w_3 =</span> (wave_3 <span class="sc">-</span> wave_1)<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>          <span class="at">w_4 =</span> (wave_4 <span class="sc">-</span> wave_1)<span class="sc">/</span><span class="dv">365</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>        <span class="at">w_5 =</span> (wave_5 <span class="sc">-</span> wave_1)<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a>personality.long <span class="ot">&lt;-</span> personality.wide <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mapid, w_1<span class="sc">:</span>w_5) <span class="sc">%&gt;%</span> </span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="fu">gather</span>(wave, year, <span class="sc">-</span>mapid) <span class="sc">%&gt;%</span> </span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="fu">separate</span>(wave, <span class="fu">c</span>(<span class="st">'weeks'</span>, <span class="st">'wave'</span> ), <span class="at">sep=</span><span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-23"><a href="#cb5-23"></a> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>weeks) </span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a>personality.long<span class="sc">$</span>wave <span class="ot">&lt;-</span>  <span class="fu">as.numeric</span>(personality.long<span class="sc">$</span>wave)</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a>personality <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb5-29"><a href="#cb5-29"></a>   <span class="fu">left_join</span>(personality.long, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'mapid'</span>, <span class="st">'wave'</span> )) </span>
<span id="cb5-30"><a href="#cb5-30"></a></span>
<span id="cb5-31"><a href="#cb5-31"></a>personality.s <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb5-32"><a href="#cb5-32"></a>  <span class="fu">group_by</span>(mapid) <span class="sc">%&gt;%</span> </span>
<span id="cb5-33"><a href="#cb5-33"></a>  <span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-34"><a href="#cb5-34"></a>   <span class="fu">filter</span>(n <span class="sc">&gt;=</span><span class="dv">2</span>) </span>
<span id="cb5-35"><a href="#cb5-35"></a></span>
<span id="cb5-36"><a href="#cb5-36"></a> personality <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb5-37"><a href="#cb5-37"></a>   <span class="fu">filter</span>(mapid <span class="sc">%in%</span> personality.s<span class="sc">$</span>mapid)</span>
<span id="cb5-38"><a href="#cb5-38"></a></span>
<span id="cb5-39"><a href="#cb5-39"></a>personality <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb5-40"><a href="#cb5-40"></a>  <span class="fu">select</span>(<span class="sc">-</span>neodate)</span>
<span id="cb5-41"><a href="#cb5-41"></a> </span>
<span id="cb5-42"><a href="#cb5-42"></a>personality</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,636 × 10
# Groups:   mapid [620]
   mapid   age neuroticism extraversion openness agreeablness conscientiousness
   &lt;int&gt; &lt;int&gt;       &lt;int&gt;        &lt;int&gt;    &lt;int&gt;        &lt;int&gt;             &lt;int&gt;
 1 64228    72          12           32       35           37                34
 2 62688    78          12           35       26           26                34
 3 10038    79          13           33       19           33                37
 4 62689    67          19           17       34           34                24
 5 61654    84          26           28       26           28                32
 6 12445    90          14           30       18           37                33
 7 61639    77          17           35       19           35                30
 8 60906    73           7           38       35           31                38
 9 61637    73          20           23       25           33                29
10 61225    76           4           42       21           37                37
# ℹ 1,626 more rows
# ℹ 3 more variables: gender &lt;chr&gt;, wave &lt;dbl&gt;, year &lt;drtn&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> year <span class="sc">+</span> (year <span class="sc">|</span> mapid), <span class="at">data=</span>personality)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">summary</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: extraversion ~ year + (year | mapid)
   Data: personality

REML criterion at convergence: 9859.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.3629 -0.4324  0.0085  0.4819  4.5266 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 mapid    (Intercept) 30.30045 5.505        
          year         0.03647 0.191    0.32
 Residual             10.37352 3.221        
Number of obs: 1634, groups:  mapid, 620

Fixed effects:
            Estimate Std. Error t value
(Intercept) 29.85895    0.24827 120.267
year        -0.15794    0.02931  -5.389

Correlation of Fixed Effects:
     (Intr)
year -0.220</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>quadratic</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year  <span class="sc">|</span> mapid), <span class="at">data=</span>personality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I() wont work on difftime objects. Booo</p>
</section>
<section class="slide level2">

<p>quadratic</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>personality <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>p2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year <span class="sc">|</span> mapid), <span class="at">data=</span>personality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">summary</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: extraversion ~ year + I(year^2) + (1 + year | mapid)
   Data: personality

REML criterion at convergence: 9862.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.3351 -0.4397  0.0049  0.4777  4.4871 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 mapid    (Intercept) 30.41595 5.5151       
          year         0.03525 0.1878   0.29
 Residual             10.35605 3.2181       
Number of obs: 1634, groups:  mapid, 620

Fixed effects:
             Estimate Std. Error t value
(Intercept) 29.965966   0.253474 118.221
year        -0.313374   0.077231  -4.058
I(year^2)    0.019067   0.008721   2.186

Correlation of Fixed Effects:
          (Intr) year  
year      -0.265       
I(year^2)  0.195 -0.926</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h4 id="the-importance-of-centering">The importance of centering</h4>
<ul>
<li>This is an interaction model, where you have a level 1 interaction. As such, centering is important to correctly interpret parameters.</li>
</ul>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>personality <span class="ot">&lt;-</span> personality <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> year <span class="sc">-</span> <span class="fl">3.10</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>p3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> year.c <span class="sc">+</span> <span class="fu">I</span>(year.c<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">|</span> mapid), <span class="at">data=</span>personality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">summary</span>(p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: extraversion ~ year.c + I(year.c^2) + (1 + year.c | mapid)
   Data: personality

REML criterion at convergence: 9862.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.3351 -0.4397  0.0049  0.4777  4.4871 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 mapid    (Intercept) 32.63250 5.7125       
          year.c       0.03527 0.1878   0.38
 Residual             10.35587 3.2181       
Number of obs: 1634, groups:  mapid, 620

Fixed effects:
             Estimate Std. Error t value
(Intercept) 29.177742   0.259875 112.276
year.c      -0.195157   0.034015  -5.737
I(year.c^2)  0.019067   0.008721   2.186

Correlation of Fixed Effects:
            (Intr) year.c
year.c       0.286       
I(year.c^2) -0.340 -0.512</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>graphically, what does this look like?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>personality <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.1</span>,<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">.model =</span> personality) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">add_predictions</span>(p3) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>   <span class="fu">group_by</span>(year.c) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">pred =</span> <span class="fu">mean</span>(pred)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year.c, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>non-centered model</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>personality <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">data_grid</span>(<span class="at">year =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">13</span>, <span class="dv">1</span>), <span class="at">.model =</span> personality) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">add_predictions</span>(p2) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>   <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">pred =</span> <span class="fu">mean</span>(pred)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>personality <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">data_grid</span>(<span class="at">year.c =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">10</span>, <span class="dv">1</span>), <span class="at">.model =</span> personality) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">add_predictions</span>(p3) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year.c, <span class="at">y =</span> pred, <span class="at">group =</span> mapid)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>compare with a linear model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">anova</span>(p3, p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: personality
Models:
p1: extraversion ~ year + (year | mapid)
p3: extraversion ~ year.c + I(year.c^2) + (1 + year.c | mapid)
   npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
p1    6 9865.3 9897.7 -4926.7   9853.3                       
p3    7 9862.6 9900.4 -4924.3   9848.6 4.7373  1    0.02952 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="sem-poly-example" class="slide level2">
<h2>SEM poly example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#use alcohol data from before</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>alcohol <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2022/main/alcohol1_pp.csv"</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>alcohol.wide <span class="ot">&lt;-</span> alcohol <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X, <span class="sc">-</span>age_14, <span class="sc">-</span>ccoa) <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"age"</span>, </span>
<span id="cb21-7"><a href="#cb21-7"></a>              <span class="at">names_prefix =</span> <span class="st">"alcuse_"</span>,</span>
<span id="cb21-8"><a href="#cb21-8"></a>              <span class="at">values_from  =</span> alcuse) </span>
<span id="cb21-9"><a href="#cb21-9"></a>alcohol.wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 82 × 8
      id   coa  male  peer  cpeer alcuse_14 alcuse_15 alcuse_16
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1     1     1     0 1.26   0.247      1.73      2         2   
 2     2     1     1 0.894 -0.124      0         0         1   
 3     3     1     1 0.894 -0.124      1         2         3.32
 4     4     1     1 1.79   0.771      0         2         1.73
 5     5     1     0 0.894 -0.124      0         0         0   
 6     6     1     1 1.55   0.531      3         3         3.16
 7     7     1     0 1.55   0.531      1.73      2.45      1   
 8     8     1     1 0     -1.02       0         0         0   
 9     9     1     1 0     -1.02       0         1         3.46
10    10     1     0 2      0.982      1         1         1   
# ℹ 72 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="st">'  </span></span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">i =~ 1*alcuse_14 + 1*alcuse_15 + 1*alcuse_16 </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">s =~ 0*alcuse_14 + 2*alcuse_15 + 4*alcuse_16</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">q =~ 0*alcuse_14 + 4*alcuse_15 + 16*alcuse_16  </span></span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="st">q~~0*q</span></span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="st">alcuse_14~~a*alcuse_14</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="st">alcuse_15~~a*alcuse_15</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="st">alcuse_16~~a*alcuse_16</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="st">'</span></span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a>p4 <span class="ot">&lt;-</span> <span class="fu">growth</span>(model<span class="fl">.4</span>, <span class="at">data =</span> alcohol.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="centering-in-sem" class="slide level2">
<h2>centering in SEM</h2>
<p>Because we control the scaling of time via our constraints we do not need to explicitly center time in the same way we did in the MLM model</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">summary</span>(p4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 37 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        11
  Number of equality constraints                     2

  Number of observations                            82
  Number of missing patterns                         1

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    alcuse_14         1.000                           
    alcuse_15         1.000                           
    alcuse_16         1.000                           
  s =~                                                
    alcuse_14         0.000                           
    alcuse_15         2.000                           
    alcuse_16         4.000                           
  q =~                                                
    alcuse_14         0.000                           
    alcuse_15         4.000                           
    alcuse_16        16.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s                 0.110    0.084    1.309    0.191
    q                -0.034    0.019   -1.786    0.074
  s ~~                                                
    q                 0.007    0.006    1.200    0.230

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .alcuse_14         0.000                           
   .alcuse_15         0.000                           
   .alcuse_16         0.000                           
    i                 0.630    0.103    6.118    0.000
    s                 0.198    0.080    2.465    0.014
    q                -0.016    0.020   -0.799    0.424

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    q                 0.000                           
   .alcuse_14  (a)    0.335    0.052    6.403    0.000
   .alcuse_15  (a)    0.335    0.052    6.403    0.000
   .alcuse_16  (a)    0.335    0.052    6.403    0.000
    i                 0.536    0.146    3.683    0.000
    s                -0.015    0.046   -0.338    0.735</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Lets use the personality data from the mlm above. First gotta convert into wide.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>personality2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2022/main/Subject_personality.csv"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a>p.wide<span class="ot">&lt;-</span> personality2 <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">group_by</span>(mapid) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">arrange</span>(neodate) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">seq_len</span>(<span class="fu">n</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(age<span class="sc">:</span>neuroticism), <span class="sc">-</span><span class="fu">c</span>(openness<span class="sc">:</span>gender)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"wave"</span>, <span class="at">values_from =</span> <span class="st">"extraversion"</span>,<span class="at">names_prefix =</span> <span class="st">"extra_"</span>)</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a>p.wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,090 × 6
# Groups:   mapid [1,090]
   mapid extra_1 extra_2 extra_3 extra_4 extra_5
   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;
 1 64228      32      34      NA      NA      NA
 2 62688      35      31      35      29      30
 3 62685      28      NA      NA      NA      NA
 4 10038      33      28      NA      NA      NA
 5 62689      17      18      15      NA      NA
 6 61654      28      26      NA      NA      NA
 7 12445      30      32      NA      NA      NA
 8 61639      35      27      30      NA      NA
 9 60906      38      40      32      41      NA
10 61637      23      28      28      14      20
# ℹ 1,080 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="st">'  </span></span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="st">s =~ 0*extra_1 + 1*extra_2 + 2*extra_3 + 3*extra_4 + 4*extra_5 </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="st">q =~ 0*extra_1 + 1*extra_2 + 4*extra_3 + 9*extra_4 + 16*extra_5  </span></span>
<span id="cb28-6"><a href="#cb28-6"></a></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="st">'</span></span>
<span id="cb28-8"><a href="#cb28-8"></a></span>
<span id="cb28-9"><a href="#cb28-9"></a>p5 <span class="ot">&lt;-</span> <span class="fu">growth</span>(model<span class="fl">.5</span>, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">summary</span>(p5, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 135 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 3.742
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.712

Model Test Baseline Model:

  Test statistic                               939.752
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.004
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.025

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6459.688
  Loglikelihood unrestricted model (H1)      -6457.817
                                                      
  Akaike (AIC)                               12947.377
  Bayesian (BIC)                             13017.292
  Sample-size adjusted Bayesian (SABIC)      12972.825

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.029
  P-value H_0: RMSEA &lt;= 0.050                    0.999
  P-value H_0: RMSEA &gt;= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.150
  P-value H_0: Robust RMSEA &lt;= 0.050             0.781
  P-value H_0: Robust RMSEA &gt;= 0.080             0.166

Standardized Root Mean Square Residual:

  SRMR                                           0.024

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    extra_1           1.000                               5.180    0.820
    extra_2           1.000                               5.180    0.780
    extra_3           1.000                               5.180    0.759
    extra_4           1.000                               5.180    0.734
    extra_5           1.000                               5.180    0.752
  s =~                                                                  
    extra_1           0.000                                  NA       NA
    extra_2           1.000                                  NA       NA
    extra_3           2.000                                  NA       NA
    extra_4           3.000                                  NA       NA
    extra_5           4.000                                  NA       NA
  q =~                                                                  
    extra_1           0.000                               0.000    0.000
    extra_2           1.000                               0.261    0.039
    extra_3           4.000                               1.045    0.153
    extra_4           9.000                               2.351    0.333
    extra_5          16.000                               4.179    0.607

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~~                                                                  
    s                 4.817    3.225    1.494    0.135    1.377    1.377
    q                -0.904    0.827   -1.093    0.274   -0.668   -0.668
  s ~~                                                                  
    q                -0.051    0.972   -0.053    0.958   -0.290   -0.290

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1           0.000                               0.000    0.000
   .extra_2           0.000                               0.000    0.000
   .extra_3           0.000                               0.000    0.000
   .extra_4           0.000                               0.000    0.000
   .extra_5           0.000                               0.000    0.000
    i                29.405    0.190  154.581    0.000    5.677    5.677
    s                -0.781    0.225   -3.476    0.001       NA       NA
    q                 0.128    0.080    1.590    0.112    0.489    0.489

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1          13.055    2.799    4.663    0.000   13.055    0.327
   .extra_2           9.982    1.243    8.033    0.000    9.982    0.226
   .extra_3           9.300    1.583    5.875    0.000    9.300    0.200
   .extra_4          11.696    2.320    5.040    0.000   11.696    0.235
   .extra_5           7.360    6.898    1.067    0.286    7.360    0.155
    i                26.829    3.095    8.669    0.000    1.000    1.000
    s                -0.456    3.746   -0.122    0.903       NA       NA
    q                 0.068    0.277    0.246    0.806    1.000    1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>constrain variances</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="st">'  </span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="st">s =~ 0*extra_1 + 1*extra_2 + 2*extra_3 + 3*extra_4 + 4*extra_5 </span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="st">q =~ 0*extra_1 + 1*extra_2 + 4*extra_3 + 9*extra_4 + 16*extra_5  </span></span>
<span id="cb31-6"><a href="#cb31-6"></a></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="st">extra_1 ~~ Q*extra_1</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="st">extra_2 ~~ Q*extra_2</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="st">extra_3 ~~ Q*extra_3</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="st">extra_4 ~~ Q*extra_4</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="st">extra_5 ~~ Q*extra_5</span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="st">'</span></span>
<span id="cb31-13"><a href="#cb31-13"></a></span>
<span id="cb31-14"><a href="#cb31-14"></a>p6 <span class="ot">&lt;-</span> <span class="fu">growth</span>(model<span class="fl">.6</span>, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">summary</span>(p6, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 117 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14
  Number of equality constraints                     4

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 7.002
  Degrees of freedom                                10
  P-value (Chi-square)                           0.725

Model Test Baseline Model:

  Test statistic                               939.752
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.003
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.026

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6461.318
  Loglikelihood unrestricted model (H1)      -6457.817
                                                      
  Akaike (AIC)                               12942.636
  Bayesian (BIC)                             12992.575
  Sample-size adjusted Bayesian (SABIC)      12960.813

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.024
  P-value H_0: RMSEA &lt;= 0.050                    1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.076
  P-value H_0: Robust RMSEA &lt;= 0.050             0.921
  P-value H_0: Robust RMSEA &gt;= 0.080             0.046

Standardized Root Mean Square Residual:

  SRMR                                           0.021

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    extra_1           1.000                               5.407    0.858
    extra_2           1.000                               5.407    0.812
    extra_3           1.000                               5.407    0.787
    extra_4           1.000                               5.407    0.779
    extra_5           1.000                               5.407    0.766
  s =~                                                                  
    extra_1           0.000                               0.000    0.000
    extra_2           1.000                               1.144    0.172
    extra_3           2.000                               2.288    0.333
    extra_4           3.000                               3.432    0.495
    extra_5           4.000                               4.576    0.648
  q =~                                                                  
    extra_1           0.000                               0.000    0.000
    extra_2           1.000                               0.347    0.052
    extra_3           4.000                               1.387    0.202
    extra_4           9.000                               3.121    0.450
    extra_5          16.000                               5.549    0.786

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~~                                                                  
    s                 2.316    1.646    1.407    0.159    0.374    0.374
    q                -0.357    0.516   -0.693    0.489   -0.191   -0.191
  s ~~                                                                  
    q                -0.381    0.735   -0.518    0.605   -0.959   -0.959

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1           0.000                               0.000    0.000
   .extra_2           0.000                               0.000    0.000
   .extra_3           0.000                               0.000    0.000
   .extra_4           0.000                               0.000    0.000
   .extra_5           0.000                               0.000    0.000
    i                29.409    0.190  154.572    0.000    5.439    5.439
    s                -0.794    0.225   -3.537    0.000   -0.694   -0.694
    q                 0.132    0.080    1.648    0.099    0.381    0.381

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1    (Q)   10.482    0.823   12.730    0.000   10.482    0.264
   .extra_2    (Q)   10.482    0.823   12.730    0.000   10.482    0.237
   .extra_3    (Q)   10.482    0.823   12.730    0.000   10.482    0.222
   .extra_4    (Q)   10.482    0.823   12.730    0.000   10.482    0.218
   .extra_5    (Q)   10.482    0.823   12.730    0.000   10.482    0.210
    i                29.237    1.870   15.635    0.000    1.000    1.000
    s                 1.309    2.633    0.497    0.619    1.000    1.000
    q                 0.120    0.216    0.558    0.577    1.000    1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">head</span>(<span class="fu">lavPredict</span>(p6,<span class="at">type=</span><span class="st">"lv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            i          s             q
[1,] 32.65393 -0.4115328  0.0542173074
[2,] 32.35908 -0.3016062 -0.0001687605
[3,] 28.37174 -0.8763890  0.1449828120
[4,] 30.56915 -0.8415910  0.1606965177
[5,] 19.08634 -1.7300094  0.2917956478
[6,] 27.68981 -0.9944495  0.1728991739</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">head</span>(<span class="fu">lavPredict</span>(p6,<span class="at">type=</span><span class="st">"ov"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      extra_1  extra_2  extra_3  extra_4  extra_5
[1,] 32.65393 32.29662 32.04774 31.90729 31.87528
[2,] 32.35908 32.05731 31.75520 31.45275 31.14996
[3,] 28.37174 27.64033 27.19889 27.04742 27.18591
[4,] 30.56915 29.88826 29.52875 29.49065 29.77393
[5,] 19.08634 17.64813 16.79350 16.52247 16.83503
[6,] 27.68981 26.86826 26.39251 26.26255 26.47840</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">as_tibble</span>(<span class="fu">lavPredict</span>(p6,<span class="at">type=</span><span class="st">"ov"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"extra"</span>), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"wave"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> extra, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section>
<section id="sem-latent-basis" class="slide level2">
<h2>SEM latent basis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="st">'  </span></span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="st">s =~ 0*extra_1 + extra_2 + extra_3 + extra_4 + 4*extra_5 </span></span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="st">'</span></span>
<span id="cb39-8"><a href="#cb39-8"></a></span>
<span id="cb39-9"><a href="#cb39-9"></a>p7 <span class="ot">&lt;-</span> <span class="fu">growth</span>(model<span class="fl">.7</span>, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">summary</span>(p7, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 174 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        13

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 3.688
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.815

Model Test Baseline Model:

  Test statistic                               939.752
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.005
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.032

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6459.661
  Loglikelihood unrestricted model (H1)      -6457.817
                                                      
  Akaike (AIC)                               12945.323
  Bayesian (BIC)                             13010.244
  Sample-size adjusted Bayesian (SABIC)      12968.953

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.023
  P-value H_0: RMSEA &lt;= 0.050                    1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.123
  P-value H_0: Robust RMSEA &lt;= 0.050             0.858
  P-value H_0: Robust RMSEA &gt;= 0.080             0.103

Standardized Root Mean Square Residual:

  SRMR                                           0.033

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    extra_1           1.000                               5.281    0.837
    extra_2           1.000                               5.281    0.792
    extra_3           1.000                               5.281    0.781
    extra_4           1.000                               5.281    0.753
    extra_5           1.000                               5.281    0.726
  s =~                                                                  
    extra_1           0.000                               0.000    0.000
    extra_2           1.893    0.989    1.914    0.056    0.366    0.055
    extra_3           2.670    1.372    1.946    0.052    0.516    0.076
    extra_4           2.745    1.710    1.605    0.108    0.531    0.076
    extra_5           4.000                               0.773    0.106

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~~                                                                  
    s                 1.629    1.070    1.522    0.128    1.596    1.596

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1           0.000                               0.000    0.000
   .extra_2           0.000                               0.000    0.000
   .extra_3           0.000                               0.000    0.000
   .extra_4           0.000                               0.000    0.000
   .extra_5           0.000                               0.000    0.000
    i                29.423    0.191  154.034    0.000    5.571    5.571
    s                -0.386    0.197   -1.960    0.050   -1.995   -1.995

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1          11.965    2.674    4.474    0.000   11.965    0.300
   .extra_2          10.299    1.219    8.447    0.000   10.299    0.231
   .extra_3           8.893    1.334    6.667    0.000    8.893    0.194
   .extra_4          12.090    2.246    5.384    0.000   12.090    0.246
   .extra_5          11.454    4.373    2.619    0.009   11.454    0.216
    i                27.891    3.054    9.134    0.000    1.000    1.000
    s                 0.037    0.503    0.074    0.941    1.000    1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">as_tibble</span>(<span class="fu">lavPredict</span>(p7,<span class="at">type=</span><span class="st">"ov"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"extra"</span>), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"wave"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> extra, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="piecewise" class="slide level2">
<h2>Piecewise</h2>
<ul>
<li><p>Fit more than 1 trajectory</p></li>
<li><p>Best to use when we have a reason for a qualitative difference at a time point. For example, before your health event you may have a different trajectory than after</p></li>
<li><p>Time modeled as dummy variables that represent different segments</p></li>
<li><p>The point of separation is called a knot. You can have as many as you want and these can be pre-specified or let the data specify</p></li>
</ul>
</section>
<section class="slide level2">

<h4 id="two-rate-specification">two-rate specification</h4>
<ul>
<li>The easiest example is to take your time variable and transform it into a Time1 and time2, that represent the different time periods</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb43-2"><a href="#cb43-2"></a>  <span class="sc">~</span>time, <span class="sc">~</span>t0, <span class="sc">~</span>t1,<span class="sc">~</span>t2,<span class="sc">~</span>t3,<span class="sc">~</span>t4,<span class="sc">~</span>t5,</span>
<span id="cb43-3"><a href="#cb43-3"></a>  <span class="st">"time 1"</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,</span>
<span id="cb43-4"><a href="#cb43-4"></a>  <span class="st">"time 2"</span>, <span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>)</span>
<span id="cb43-6"><a href="#cb43-6"></a>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  time      t0    t1    t2    t3    t4    t5
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 time 1     0     1     2     2     2     2
2 time 2     0     0     0     1     2     3</code></pre>
</div>
</div>
<ul>
<li>Once you hit the knot your value stays the same. For the second curve, until you get to knot you don’t have a trajectory.</li>
</ul>
</section>
<section class="slide level2">

<h4 id="incremental-curves">incremental curves</h4>
<ul>
<li>Here the first trajectory keeps going, whereas the second trajectory starts at the position of the knot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="sc">~</span>time, <span class="sc">~</span>t0, <span class="sc">~</span>t1,<span class="sc">~</span>t2,<span class="sc">~</span>t3,<span class="sc">~</span>t4,<span class="sc">~</span>t5,</span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="st">"time 1"</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,</span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="st">"time 2"</span>, <span class="dv">0</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>)</span>
<span id="cb45-6"><a href="#cb45-6"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  time      t0    t1    t2    t3    t4    t5
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 time 1     0     1     2     3     4     5
2 time 2     0     0     0     1     2     3</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>The two coding schemes propose the same type of trajectory, the difference is in interpretation.</li>
<li>In the first, the two slope coefficients represent the actual slope in the respective time period.</li>
<li>In the second, the coefficient for time 2 represents the deviation from the slope in period 1.</li>
</ul>
</section>
<section id="mlm-example" class="slide level2">
<h2>mlm example</h2>
<p>level 1:</p>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}Time1_{ij} + \beta_{2j}Time2_{ij} + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} +  U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} +  U_{1j}\]</span> <span class="math display">\[{\beta}_{2j} = \gamma_{20} +  U_{2j}\]</span></p>
</section>
<section class="slide level2">

<p>0 1 2 2 2<br>
0 0 0 1 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>personality<span class="sc">$</span>time1 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">recode</span>(personality<span class="sc">$</span>wave, <span class="st">'1'</span> <span class="ot">=</span> <span class="dv">0</span> , <span class="st">'2'</span> <span class="ot">=</span> <span class="dv">1</span>,  <span class="st">'3'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'4'</span> <span class="ot">=</span> <span class="dv">2</span>,<span class="st">'5'</span> <span class="ot">=</span> <span class="dv">2</span>)      </span>
<span id="cb47-2"><a href="#cb47-2"></a>personality<span class="sc">$</span>time2 <span class="ot">&lt;-</span> <span class="fu">recode</span>(personality<span class="sc">$</span>wave, <span class="st">'1'</span> <span class="ot">=</span> <span class="dv">0</span> , <span class="st">'2'</span> <span class="ot">=</span> <span class="dv">0</span>,  <span class="st">'3'</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">'4'</span> <span class="ot">=</span> <span class="dv">1</span>,<span class="st">'5'</span> <span class="ot">=</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> time1 <span class="sc">+</span> time2 <span class="sc">+</span> (time2 <span class="sc">|</span> mapid) , <span class="at">data=</span>personality)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">summary</span>(p7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: extraversion ~ time1 + time2 + (time2 | mapid)
   Data: personality

REML criterion at convergence: 9869.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.4177 -0.4572  0.0143  0.4976  4.4418 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 mapid    (Intercept) 31.9783  5.6549       
          time2        0.7177  0.8472   0.26
 Residual             10.8065  3.2873       
Number of obs: 1635, groups:  mapid, 620

Fixed effects:
            Estimate Std. Error t value
(Intercept) 29.89139    0.25838 115.687
time1       -0.58856    0.12085  -4.870
time2       -0.07393    0.30424  -0.243

Correlation of Fixed Effects:
      (Intr) time1 
time1 -0.342       
time2  0.070 -0.290</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>0 1 3 4 5 (Wave)<br>
0 0 0 1 2 (same as time 2 previously)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>p8 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(extraversion <span class="sc">~</span> wave <span class="sc">+</span> time2 <span class="sc">+</span> (time2  <span class="sc">|</span> mapid) , <span class="at">data=</span>personality)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">summary</span>(p8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: extraversion ~ wave + time2 + (time2 | mapid)
   Data: personality

REML criterion at convergence: 9869.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.4177 -0.4572  0.0143  0.4976  4.4418 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 mapid    (Intercept) 31.9783  5.6549       
          time2        0.7177  0.8472   0.26
 Residual             10.8065  3.2873       
Number of obs: 1635, groups:  mapid, 620

Fixed effects:
            Estimate Std. Error t value
(Intercept)  30.4799     0.3205  95.099
wave         -0.5886     0.1209  -4.870
time2         0.5146     0.3584   1.436

Correlation of Fixed Effects:
      (Intr) wave  
wave  -0.653       
time2  0.361 -0.583</code></pre>
</div>
</div>
</section>
<section id="sem-example" class="slide level2">
<h2>SEM example</h2>
<p>0 1 2 2 2<br>
0 0 0 1 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>two.rate <span class="ot">&lt;-</span> <span class="st">'i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="st">s1 =~ 0*extra_1 + 1*extra_2 + 2*extra_3 + 2*extra_4 + 2*extra_5 </span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="st">s2 =~ 0*extra_1 + 0*extra_2 + 0*extra_3 + 1*extra_4 + 2*extra_5  </span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="st">'</span></span>
<span id="cb52-5"><a href="#cb52-5"></a></span>
<span id="cb52-6"><a href="#cb52-6"></a>p8 <span class="ot">&lt;-</span> <span class="fu">growth</span>(two.rate, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">summary</span>(p8, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 141 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 4.756
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.575

Model Test Baseline Model:

  Test statistic                               939.752
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.002
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.027

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6460.195
  Loglikelihood unrestricted model (H1)      -6457.817
                                                      
  Akaike (AIC)                               12948.391
  Bayesian (BIC)                             13018.306
  Sample-size adjusted Bayesian (SABIC)      12973.839

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.034
  P-value H_0: RMSEA &lt;= 0.050                    0.997
  P-value H_0: RMSEA &gt;= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.148
  P-value H_0: Robust RMSEA &lt;= 0.050             0.794
  P-value H_0: Robust RMSEA &gt;= 0.080             0.156

Standardized Root Mean Square Residual:

  SRMR                                           0.021

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    extra_1           1.000                               5.328    0.844
    extra_2           1.000                               5.328    0.803
    extra_3           1.000                               5.328    0.777
    extra_4           1.000                               5.328    0.760
    extra_5           1.000                               5.328    0.768
  s1 =~                                                                 
    extra_1           0.000                               0.000    0.000
    extra_2           1.000                               0.616    0.093
    extra_3           2.000                               1.231    0.180
    extra_4           2.000                               1.231    0.176
    extra_5           2.000                               1.231    0.177
  s2 =~                                                                 
    extra_1           0.000                               0.000    0.000
    extra_2           0.000                               0.000    0.000
    extra_3           0.000                               0.000    0.000
    extra_4           1.000                               1.396    0.199
    extra_5           2.000                               2.793    0.402

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~~                                                                  
    s1                2.278    1.301    1.750    0.080    0.694    0.694
    s2               -0.202    1.952   -0.103    0.918   -0.027   -0.027
  s1 ~~                                                                 
    s2               -0.686    1.175   -0.584    0.559   -0.798   -0.798

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1           0.000                               0.000    0.000
   .extra_2           0.000                               0.000    0.000
   .extra_3           0.000                               0.000    0.000
   .extra_4           0.000                               0.000    0.000
   .extra_5           0.000                               0.000    0.000
    i                29.381    0.189  155.420    0.000    5.514    5.514
    s1               -0.536    0.121   -4.443    0.000   -0.871   -0.871
    s2               -0.087    0.332   -0.262    0.793   -0.062   -0.062

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1          11.486    1.886    6.090    0.000   11.486    0.288
   .extra_2          10.735    1.145    9.379    0.000   10.735    0.244
   .extra_3           7.957    2.241    3.551    0.000    7.957    0.169
   .extra_4          11.353    2.344    4.844    0.000   11.353    0.231
   .extra_5           7.633    5.576    1.369    0.171    7.633    0.159
    i                28.390    2.293   12.382    0.000    1.000    1.000
    s1                0.379    1.057    0.359    0.720    1.000    1.000
    s2                1.950    2.305    0.846    0.398    1.000    1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>0 1 2 3 4<br>
0 0 0 1 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>incremental <span class="ot">&lt;-</span> <span class="st">'i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="st">s1 =~ 0*extra_1 + 1*extra_2 + 2*extra_3 + 3*extra_4 + 4*extra_5 </span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="st">s2 =~ 0*extra_1 + 0*extra_2 + 0*extra_3 + 1*extra_4 + 2*extra_5  </span></span>
<span id="cb55-4"><a href="#cb55-4"></a><span class="st">'</span></span>
<span id="cb55-5"><a href="#cb55-5"></a></span>
<span id="cb55-6"><a href="#cb55-6"></a>p9 <span class="ot">&lt;-</span> <span class="fu">growth</span>(incremental, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">summary</span>(p9, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 150 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 4.756
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.575

Model Test Baseline Model:

  Test statistic                               939.752
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.002
                                                      
  Robust Comparative Fit Index (CFI)             1.000
  Robust Tucker-Lewis Index (TLI)                1.027

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6460.195
  Loglikelihood unrestricted model (H1)      -6457.817
                                                      
  Akaike (AIC)                               12948.391
  Bayesian (BIC)                             13018.306
  Sample-size adjusted Bayesian (SABIC)      12973.839

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.034
  P-value H_0: RMSEA &lt;= 0.050                    0.997
  P-value H_0: RMSEA &gt;= 0.080                    0.000
                                                      
  Robust RMSEA                                   0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.148
  P-value H_0: Robust RMSEA &lt;= 0.050             0.794
  P-value H_0: Robust RMSEA &gt;= 0.080             0.156

Standardized Root Mean Square Residual:

  SRMR                                           0.021

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    extra_1           1.000                               5.328    0.844
    extra_2           1.000                               5.328    0.803
    extra_3           1.000                               5.328    0.777
    extra_4           1.000                               5.328    0.760
    extra_5           1.000                               5.328    0.768
  s1 =~                                                                 
    extra_1           0.000                               0.000    0.000
    extra_2           1.000                               0.616    0.093
    extra_3           2.000                               1.231    0.180
    extra_4           3.000                               1.847    0.263
    extra_5           4.000                               2.463    0.355
  s2 =~                                                                 
    extra_1           0.000                               0.000    0.000
    extra_2           0.000                               0.000    0.000
    extra_3           0.000                               0.000    0.000
    extra_4           1.000                               1.924    0.274
    extra_5           2.000                               3.848    0.555

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~~                                                                  
    s1                2.278    1.301    1.750    0.080    0.694    0.694
    s2               -2.479    2.723   -0.911    0.363   -0.242   -0.242
  s1 ~~                                                                 
    s2               -1.065    2.080   -0.512    0.609   -0.899   -0.899

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1           0.000                               0.000    0.000
   .extra_2           0.000                               0.000    0.000
   .extra_3           0.000                               0.000    0.000
   .extra_4           0.000                               0.000    0.000
   .extra_5           0.000                               0.000    0.000
    i                29.381    0.189  155.420    0.000    5.514    5.514
    s1               -0.536    0.121   -4.443    0.000   -0.871   -0.871
    s2                0.449    0.383    1.173    0.241    0.233    0.233

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .extra_1          11.486    1.886    6.090    0.000   11.486    0.288
   .extra_2          10.735    1.145    9.379    0.000   10.735    0.244
   .extra_3           7.957    2.241    3.551    0.000    7.957    0.169
   .extra_4          11.353    2.344    4.844    0.000   11.353    0.231
   .extra_5           7.633    5.576    1.369    0.171    7.633    0.159
    i                28.390    2.293   12.382    0.000    1.000    1.000
    s1                0.379    1.057    0.359    0.720    1.000    1.000
    s2                3.702    5.088    0.728    0.467    1.000    1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">as_tibble</span>(<span class="fu">lavPredict</span>(p9,<span class="at">type=</span><span class="st">"ov"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"extra"</span>), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"wave"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> extra, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>different model, same figure?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">as_tibble</span>(<span class="fu">lavPredict</span>(p8,<span class="at">type=</span><span class="st">"ov"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"extra"</span>), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"wave"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> extra, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-41-1.png" width="960" class="r-stretch"></section>
<section id="splines-polynomial-polynomial-piecewise" class="slide level2">
<h2>splines + polynomial = polynomial piecewise</h2>
<p><span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}Time1_{ij} +  \beta_{2j}Time1_{ij}^2 + \beta_{3j}Time2_{ij} + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} +  U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} +  U_{1j}\]</span> <span class="math display">\[{\beta}_{2j} = \gamma_{20} +  U_{2j}\]</span> <span class="math display">\[{\beta}_{3j} = \gamma_{30} +  U_{3j}\]</span></p>
</section>
<section class="slide level2">

<p>you really should have more waves per piece to model piecewise polynomial, but hey lets try it:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>two.rate.poly <span class="ot">&lt;-</span> <span class="st">'i =~ 1*extra_1 + 1*extra_2 + 1*extra_3 + 1*extra_4 + 1*extra_5 </span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="st">s1 =~ -2*extra_1 + -1*extra_2 + 0*extra_3 + 0*extra_4 + 0*extra_5 </span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="st">s2 =~ 0*extra_1 + 0*extra_2 + 0*extra_3 + 1*extra_4 + 2*extra_5  </span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="st">s2poly =~ 0*extra_1 + 0*extra_2 + 0*extra_3 + 1*extra_4 + 4*extra_5 </span></span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="st">extra_1 ~~ Q*extra_1</span></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="st">extra_2 ~~ Q*extra_2</span></span>
<span id="cb60-8"><a href="#cb60-8"></a><span class="st">extra_3 ~~ Q*extra_3</span></span>
<span id="cb60-9"><a href="#cb60-9"></a><span class="st">extra_4 ~~ Q*extra_4</span></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="st">extra_5 ~~ Q*extra_5</span></span>
<span id="cb60-11"><a href="#cb60-11"></a></span>
<span id="cb60-12"><a href="#cb60-12"></a><span class="st">s2poly~~0*s2poly</span></span>
<span id="cb60-13"><a href="#cb60-13"></a></span>
<span id="cb60-14"><a href="#cb60-14"></a><span class="st">'</span></span>
<span id="cb60-15"><a href="#cb60-15"></a></span>
<span id="cb60-16"><a href="#cb60-16"></a>p9 <span class="ot">&lt;-</span> <span class="fu">growth</span>(two.rate.poly, <span class="at">data =</span> p.wide, <span class="at">missing =</span> <span class="st">"ML"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">summary</span>(p9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 150 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18
  Number of equality constraints                     4

  Number of observations                          1090
  Number of missing patterns                         6

Model Test User Model:
                                                      
  Test statistic                                 7.609
  Degrees of freedom                                 6
  P-value (Chi-square)                           0.268

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i =~                                                
    extra_1           1.000                           
    extra_2           1.000                           
    extra_3           1.000                           
    extra_4           1.000                           
    extra_5           1.000                           
  s1 =~                                               
    extra_1          -2.000                           
    extra_2          -1.000                           
    extra_3           0.000                           
    extra_4           0.000                           
    extra_5           0.000                           
  s2 =~                                               
    extra_1           0.000                           
    extra_2           0.000                           
    extra_3           0.000                           
    extra_4           1.000                           
    extra_5           2.000                           
  s2poly =~                                           
    extra_1           0.000                           
    extra_2           0.000                           
    extra_3           0.000                           
    extra_4           1.000                           
    extra_5           4.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  i ~~                                                
    s1                1.865    1.128    1.654    0.098
    s2               -1.827    5.897   -0.310    0.757
    s2poly            1.135    3.266    0.347    0.728
  s1 ~~                                               
    s2               -0.449    2.026   -0.222    0.825
    s2poly            0.390    1.061    0.367    0.713
  s2 ~~                                               
    s2poly           -0.599    1.278   -0.469    0.639

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .extra_1           0.000                           
   .extra_2           0.000                           
   .extra_3           0.000                           
   .extra_4           0.000                           
   .extra_5           0.000                           
    i                28.285    0.279  101.525    0.000
    s1               -0.550    0.121   -4.528    0.000
    s2                0.282    0.876    0.322    0.747
    s2poly           -0.240    0.512   -0.468    0.640

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .extra_1    (Q)   10.938    0.725   15.087    0.000
   .extra_2    (Q)   10.938    0.725   15.087    0.000
   .extra_3    (Q)   10.938    0.725   15.087    0.000
   .extra_4    (Q)   10.938    0.725   15.087    0.000
   .extra_5    (Q)   10.938    0.725   15.087    0.000
    s2poly            0.000                           
    i                36.953    3.207   11.521    0.000
    s1               -0.171    0.659   -0.260    0.795
    s2                2.396    5.275    0.454    0.650</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">as_tibble</span>(<span class="fu">lavPredict</span>(p9,<span class="at">type=</span><span class="st">"ov"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">rowid_to_column</span>(<span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"extra"</span>), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"wave"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave, <span class="at">y =</span> extra, <span class="at">group =</span> ID, <span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-44-1.png" width="960" class="r-stretch"></section>
<section id="discontinuity-in-level-not-in-slopes" class="slide level2">
<h2>Discontinuity in level, not in slopes</h2>
<ul>
<li>The previous models modified time, and thus the trajectory. But level 1 predictors also modify the trajectory. We will cover these in more detail later, but for now…</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb64-2"><a href="#cb64-2"></a>plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, </span>
<span id="cb64-3"><a href="#cb64-3"></a>                            mapping, </span>
<span id="cb64-4"><a href="#cb64-4"></a>                            <span class="at">sizes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), </span>
<span id="cb64-5"><a href="#cb64-5"></a>                            <span class="at">linetypes =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb64-6"><a href="#cb64-6"></a>                            ...) {</span>
<span id="cb64-7"><a href="#cb64-7"></a>  </span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">ggplot</span>(data, mapping) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size =</span> model, <span class="at">linetype =</span> model)) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb64-11"><a href="#cb64-11"></a>              <span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">hjust =</span> hjust),</span>
<span id="cb64-12"><a href="#cb64-12"></a>              <span class="at">size =</span> <span class="dv">3</span>, <span class="at">parse =</span> T) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13"></a>    <span class="fu">geom_segment</span>(<span class="at">data =</span> arrow,</span>
<span id="cb64-14"><a href="#cb64-14"></a>                 <span class="fu">aes</span>(<span class="at">xend =</span> xend, <span class="at">yend =</span> yend),</span>
<span id="cb64-15"><a href="#cb64-15"></a>                 <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.075</span>, <span class="st">"inches"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb64-16"><a href="#cb64-16"></a>                 <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-17"><a href="#cb64-17"></a>    <span class="fu">scale_size_manual</span>(<span class="at">values =</span> sizes) <span class="sc">+</span></span>
<span id="cb64-18"><a href="#cb64-18"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> linetypes) <span class="sc">+</span></span>
<span id="cb64-19"><a href="#cb64-19"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="sc">+</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">1.6</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb64-21"><a href="#cb64-21"></a>    <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">1.6</span>, <span class="fl">2.4</span>)) <span class="sc">+</span></span>
<span id="cb64-22"><a href="#cb64-22"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb64-23"><a href="#cb64-23"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb64-24"><a href="#cb64-24"></a>  </span>
<span id="cb64-25"><a href="#cb64-25"></a>}</span>
<span id="cb64-26"><a href="#cb64-26"></a></span>
<span id="cb64-27"><a href="#cb64-27"></a>text <span class="ot">&lt;-</span></span>
<span id="cb64-28"><a href="#cb64-28"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">7.5</span>, <span class="fl">7.5</span>, <span class="dv">1</span>),</span>
<span id="cb64-29"><a href="#cb64-29"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.24</span>, <span class="fl">2.2</span>, <span class="fl">1.82</span>, <span class="fl">1.78</span>, <span class="fl">1.62</span>),</span>
<span id="cb64-30"><a href="#cb64-30"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Common~rate~of~change"</span>,</span>
<span id="cb64-31"><a href="#cb64-31"></a>                   <span class="st">"Pre-Post~L1~Event~(gamma[1][italic(i)])"</span>,</span>
<span id="cb64-32"><a href="#cb64-32"></a>                   <span class="st">"Elevation~differential"</span>,</span>
<span id="cb64-33"><a href="#cb64-33"></a>                   <span class="st">"on~level~1~IV~(gamma[2][italic(i)])"</span>,</span>
<span id="cb64-34"><a href="#cb64-34"></a>                   <span class="st">"DV~at~time~zero~(gamma[0][italic(i)])"</span>),</span>
<span id="cb64-35"><a href="#cb64-35"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>))</span>
<span id="cb64-36"><a href="#cb64-36"></a></span>
<span id="cb64-37"><a href="#cb64-37"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb64-38"><a href="#cb64-38"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">2.85</span>, <span class="fl">5.2</span>, <span class="fl">5.5</span>, <span class="fl">1.7</span>),</span>
<span id="cb64-39"><a href="#cb64-39"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">6.8</span>, <span class="fl">3.1</span>, <span class="fl">0.05</span>),</span>
<span id="cb64-40"><a href="#cb64-40"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">2.18</span>, <span class="fl">1.8</span>, <span class="fl">1.64</span>),</span>
<span id="cb64-41"><a href="#cb64-41"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">1.84</span>, <span class="fl">2.08</span>, <span class="fl">1.9</span>, <span class="fl">1.74</span>))</span>
<span id="cb64-42"><a href="#cb64-42"></a></span>
<span id="cb64-43"><a href="#cb64-43"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb64-44"><a href="#cb64-44"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb64-45"><a href="#cb64-45"></a>         <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-46"><a href="#cb64-46"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb64-47"><a href="#cb64-47"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-48"><a href="#cb64-48"></a>  <span class="fu">mutate</span>(<span class="at">exper2 =</span> <span class="fu">if_else</span>(ged <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, exper <span class="sc">-</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-49"><a href="#cb64-49"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb64-50"><a href="#cb64-50"></a>    model <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb64-51"><a href="#cb64-51"></a>    model <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> ged),</span>
<span id="cb64-52"><a href="#cb64-52"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span></span>
<span id="cb64-53"><a href="#cb64-53"></a>  <span class="fu">plot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw))<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"DV"</span>)</span>
<span id="cb64-54"><a href="#cb64-54"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section>
<section id="splines" class="slide level2">
<h2>Splines</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb65-3"><a href="#cb65-3"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.24</span>, <span class="fl">2.2</span>, <span class="dv">2</span>, <span class="fl">1.96</span>, <span class="fl">1.62</span>),</span>
<span id="cb65-4"><a href="#cb65-4"></a>         <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Slope~differential"</span>,</span>
<span id="cb65-5"><a href="#cb65-5"></a>                   <span class="st">"Pre-Post~knot~(gamma[2][italic(i)])"</span>,</span>
<span id="cb65-6"><a href="#cb65-6"></a>                   <span class="st">"Rate~of~change"</span>,</span>
<span id="cb65-7"><a href="#cb65-7"></a>                   <span class="st">"Pre~knot~(gamma[1][italic(i)])"</span>,</span>
<span id="cb65-8"><a href="#cb65-8"></a>                   <span class="st">"DV~at~time~0(gamma[0][italic(i)])"</span>),</span>
<span id="cb65-9"><a href="#cb65-9"></a>         <span class="at">hjust =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb65-10"><a href="#cb65-10"></a></span>
<span id="cb65-11"><a href="#cb65-11"></a>arrow <span class="ot">&lt;-</span></span>
<span id="cb65-12"><a href="#cb65-12"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>),</span>
<span id="cb65-13"><a href="#cb65-13"></a>         <span class="at">xend  =</span> <span class="fu">c</span>(<span class="fl">9.1</span>, <span class="fl">1.7</span>, <span class="fl">0.05</span>),</span>
<span id="cb65-14"><a href="#cb65-14"></a>         <span class="at">lnw   =</span> <span class="fu">c</span>(<span class="fl">2.18</span>, <span class="fl">1.93</span>, <span class="fl">1.64</span>),</span>
<span id="cb65-15"><a href="#cb65-15"></a>         <span class="at">yend  =</span> <span class="fu">c</span>(<span class="fl">2.15</span>, <span class="fl">1.84</span>, <span class="fl">1.74</span>))</span>
<span id="cb65-16"><a href="#cb65-16"></a></span>
<span id="cb65-17"><a href="#cb65-17"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb65-18"><a href="#cb65-18"></a>  <span class="fu">tibble</span>(<span class="at">exper =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb65-19"><a href="#cb65-19"></a>         <span class="at">ged   =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-20"><a href="#cb65-20"></a> tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="at">model =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb65-21"><a href="#cb65-21"></a>         <span class="fu">nesting</span>(exper, ged)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-22"><a href="#cb65-22"></a>  <span class="fu">mutate</span>(<span class="at">postexp =</span> <span class="fu">ifelse</span>(exper <span class="sc">==</span> <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-23"><a href="#cb65-23"></a>  <span class="fu">mutate</span>(<span class="at">lnw =</span> <span class="fu">case_when</span>(</span>
<span id="cb65-24"><a href="#cb65-24"></a>    model <span class="sc">==</span> <span class="st">"a"</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper,</span>
<span id="cb65-25"><a href="#cb65-25"></a>    model <span class="sc">==</span> <span class="st">"b"</span> <span class="sc">~</span> <span class="fl">1.75</span> <span class="sc">+</span> <span class="fl">0.04</span> <span class="sc">*</span> exper <span class="sc">+</span> <span class="fl">0.15</span> <span class="sc">*</span> postexp),</span>
<span id="cb65-26"><a href="#cb65-26"></a>  <span class="at">model =</span> <span class="fu">fct_rev</span>(model)) <span class="sc">%&gt;%</span></span>
<span id="cb65-27"><a href="#cb65-27"></a>  </span>
<span id="cb65-28"><a href="#cb65-28"></a>  <span class="fu">plot</span>(<span class="fu">aes</span>(<span class="at">x =</span> exper, <span class="at">y =</span> lnw)) <span class="sc">+</span></span>
<span id="cb65-29"><a href="#cb65-29"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"curve"</span>,</span>
<span id="cb65-30"><a href="#cb65-30"></a>           <span class="at">x =</span> <span class="fl">8.5</span>, <span class="at">xend =</span> <span class="fl">8.8</span>,</span>
<span id="cb65-31"><a href="#cb65-31"></a>           <span class="at">y =</span> <span class="fl">2.195</span>, <span class="at">yend =</span> <span class="fl">2.109</span>,</span>
<span id="cb65-32"><a href="#cb65-32"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.05</span>, <span class="st">"inches"</span>), <span class="at">type =</span> <span class="st">"closed"</span>, <span class="at">ends =</span> <span class="st">"both"</span>),</span>
<span id="cb65-33"><a href="#cb65-33"></a>           <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.85</span>)<span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"DV"</span>)</span>
<span id="cb65-34"><a href="#cb65-34"></a>  </span>
<span id="cb65-35"><a href="#cb65-35"></a>p2  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"></section>
<section id="generalized-growth-curves" class="slide level2">
<h2>Generalized growth curves</h2>
<ul>
<li><p>Often times your DV is not assumed to be governed by a normal data generating process. For example, we are working with count variables, or with dichotomous variables.</p></li>
<li><p>Just like with regression, you would fit different response distribution (binomial, poisson, beta, etc) and then use a link function to create a linear formula.</p></li>
<li><p>These same techniques can be applied to MLMs and thus longitudinal MLMs.</p></li>
</ul>
</section>
<section class="slide level2">

<p><span class="math display">\[y_i \sim \operatorname{Bernoulli}(p_i)\]</span> <span class="math display">\[p_i = \operatorname{logit}^{-1}(b_0)\]</span> <span class="math display">\[\operatorname{logit}(x) = \log \left ( \frac{x}{1 - x} \right )\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[y_{ij}  \sim \operatorname{Bernoulli}(p_{ij}) \\\]</span> <span class="math display">\[\operatorname{logit}(p_{ij})  = \gamma_{00} + \gamma_{10} \text{time}_{ij} + [\text{U}_{0j} + \text{U}_{1j} \text{time}_{ij}]\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb66-2"><a href="#cb66-2"></a>dogs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Library/CloudStorage/Box-Box/5165 Applied Longitudinal Data Analysis/2024/dogs.txt"</span>, <span class="at">sep=</span><span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">dog =</span> Dog)</span>
<span id="cb66-3"><a href="#cb66-3"></a>dogs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   dog t0 t1 t2 t3 t4 t5 t6 t7 t8 t9 t10 t11 t12 t13 t14 t15 t16 t17 t18 t19
1   13  1  1  0  1  0  1  0  0  0  0   0   0   0   0   0   0   0   0   0   0
2   16  1  1  1  1  1  1  1  0  1  1   1   1   1   1   0   0   0   0   0   0
3   17  1  1  1  1  1  0  0  1  0  0   1   1   0   0   1   0   1   0   0   0
4   18  1  0  0  1  1  0  0  0  0  1   0   1   0   1   0   0   0   0   0   0
5   21  1  1  1  1  1  1  1  1  0  0   0   0   0   0   0   0   0   0   0   0
6   27  1  1  1  1  1  1  0  0  0  0   1   1   0   1   0   0   0   0   0   0
7   29  1  1  1  1  1  0  1  1  1  1   1   1   0   0   0   0   0   0   0   0
8   30  1  1  1  1  1  1  1  0  0  1   1   0   0   0   0   0   0   0   0   0
9   32  1  1  1  1  1  0  1  0  1  0   0   1   0   1   1   1   0   0   0   0
10  33  1  1  1  1  0  1  1  0  0  1   0   1   0   0   0   0   0   0   0   0
11  34  1  1  1  1  1  1  1  1  1  1   0   0   0   0   0   0   1   0   0   0
12  36  1  1  1  1  1  0  0  0  0  0   1   1   0   0   0   0   0   0   0   0
13  37  1  1  1  0  0  1  0  1  1  0   0   0   0   0   0   0   0   0   0   0
14  41  1  1  1  1  0  1  0  0  1  0   0   0   0   0   0   0   0   0   0   0
15  42  1  1  1  0  1  0  0  1  0  0   0   0   0   0   0   0   0   0   0   0
16  43  1  1  1  1  1  1  1  0  0  0   0   0   0   0   0   0   0   0   0   0
17  45  1  0  1  0  1  1  1  0  1  0   0   0   0   1   0   0   0   0   0   0
18  47  1  1  1  1  0  1  0  1  0  0   0   0   0   0   0   0   0   0   0   0
19  48  1  0  1  1  1  1  0  1  1  1   0   0   0   0   0   0   0   0   0   0
20  46  1  1  1  1  0  0  1  0  1  0   0   1   0   1   0   0   0   0   0   0
21  49  1  1  1  0  0  0  0  0  1  0   0   0   0   0   0   0   0   0   0   0
22  50  1  1  0  1  0  1  0  0  0  0   0   0   0   0   0   0   1   1   0   0
23  52  1  1  1  1  1  1  1  0  0  0   0   0   0   0   0   0   0   0   0   0
24  54  1  1  1  1  1  1  1  1  0  0   0   1   0   1   1   1   0   0   1   0
25  57  1  1  1  1  1  1  0  1  0  0   0   0   1   0   1   0   0   0   0   0
26  59  1  1  0  1  0  0  0  1  0  0   1   0   0   0   0   0   0   0   0   0
27  67  1  1  1  1  0  1  0  0  0  0   0   0   0   0   0   0   0   0   0   0
28  66  1  1  1  0  1  0  1  0  0  0   1   0   1   0   0   0   0   0   0   0
29  69  1  1  1  1  0  0  1  1  0  0   0   1   0   1   0   1   0   1   0   0
30  71  1  1  1  1  0  0  0  0  0  0   1   0   1   0   0   0   0   0   0   0
   t20 t21 t22 t23 t24
1    0   0   0   0   0
2    0   0   0   0   0
3    0   0   0   0   0
4    0   0   0   0   0
5    0   0   0   0   0
6    0   0   0   0   0
7    0   0   0   0   0
8    0   0   0   0   0
9    0   1   0   0   1
10   0   0   0   0   0
11   0   0   0   0   0
12   0   0   0   0   0
13   0   0   0   0   0
14   0   0   0   0   0
15   0   0   0   0   0
16   0   0   0   0   0
17   0   0   0   0   0
18   0   0   0   0   0
19   0   0   0   0   0
20   0   0   0   0   0
21   0   0   0   0   0
22   0   0   0   0   0
23   0   0   0   0   0
24   0   0   0   0   0
25   0   0   0   0   0
26   0   0   0   0   0
27   0   0   0   0   0
28   0   0   0   0   0
29   0   0   0   0   0
30   0   0   0   0   0</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>dogs <span class="ot">&lt;-</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>  dogs <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>dog, <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="fu">mutate</span>(<span class="at">trial =</span> <span class="fu">str_remove</span>(name, <span class="st">"t"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.double</span>()) </span>
<span id="cb68-5"><a href="#cb68-5"></a>dogs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 750 × 4
     dog name      y trial
   &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;
 1    13 t0        1     0
 2    13 t1        1     1
 3    13 t2        0     2
 4    13 t3        1     3
 5    13 t4        0     4
 6    13 t5        1     5
 7    13 t6        0     6
 8    13 t7        0     7
 9    13 t8        0     8
10    13 t9        0     9
# ℹ 740 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># define the dog subset</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb70-3"><a href="#cb70-3"></a></span>
<span id="cb70-4"><a href="#cb70-4"></a>subset <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb70-5"><a href="#cb70-5"></a></span>
<span id="cb70-6"><a href="#cb70-6"></a><span class="co"># subset the data</span></span>
<span id="cb70-7"><a href="#cb70-7"></a>dogs <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="fu">filter</span>(dog <span class="sc">%in%</span> subset) <span class="sc">%&gt;%</span> </span>
<span id="cb70-9"><a href="#cb70-9"></a></span>
<span id="cb70-10"><a href="#cb70-10"></a>  <span class="co"># plot!</span></span>
<span id="cb70-11"><a href="#cb70-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb70-14"><a href="#cb70-14"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb70-15"><a href="#cb70-15"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> dog, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-49-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb71-2"><a href="#cb71-2"></a>growth.log <span class="ot">&lt;-</span> </span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dogs,</span>
<span id="cb71-4"><a href="#cb71-4"></a>      <span class="at">family =</span> bernoulli,</span>
<span id="cb71-5"><a href="#cb71-5"></a>      y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> trial <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> trial <span class="sc">|</span> dog),</span>
<span id="cb71-6"><a href="#cb71-6"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">coef =</span> Intercept),</span>
<span id="cb71-7"><a href="#cb71-7"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>), <span class="at">class =</span> b),</span>
<span id="cb71-8"><a href="#cb71-8"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb71-9"><a href="#cb71-9"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">4</span>), <span class="at">class =</span> cor)),</span>
<span id="cb71-10"><a href="#cb71-10"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">3</span>, <span class="at">chains =</span> <span class="dv">3</span>,</span>
<span id="cb71-11"><a href="#cb71-11"></a>      <span class="at">seed =</span> <span class="dv">6</span>,</span>
<span id="cb71-12"><a href="#cb71-12"></a>      <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb71-13"><a href="#cb71-13"></a>      <span class="at">file =</span> <span class="st">"growth.log"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">summary</span>(growth.log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: y ~ 0 + Intercept + trial + (1 + trial | dog) 
   Data: dogs (Number of observations: 750) 
  Draws: 3 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 3000

Group-Level Effects: 
~dog (Number of levels: 30) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(Intercept)            0.36      0.24     0.01     0.89 1.00      825
sd(trial)                0.07      0.03     0.02     0.13 1.00      528
cor(Intercept,trial)    -0.03      0.33    -0.63     0.62 1.00     1059
                     Tail_ESS
sd(Intercept)            1355
sd(trial)                 564
cor(Intercept,trial)     1805

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.07      0.22     1.65     2.51 1.00     2809     1895
trial        -0.32      0.03    -0.38    -0.27 1.00     2206     1943

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">conditional_effects</span>(growth.log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-52-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>The probability that an unfamiliar listener understands what a child says, develops from age 3 to age 8. Example pulled from T.J. Mahr’s website</p>
<p>Proportions, bounded by 0 - 1. Nonlinear in that they are going to be logistic shapped.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb75-2"><a href="#cb75-2"></a>points <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">45</span>, <span class="dv">52</span>, <span class="dv">61</span>, <span class="dv">80</span>, <span class="dv">74</span>), </span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="at">prop =</span> <span class="fu">c</span>(<span class="fl">0.146</span>, <span class="fl">0.241</span>, <span class="fl">0.571</span>, <span class="fl">0.745</span>, <span class="fl">0.843</span>, <span class="fl">0.738</span>))</span>
<span id="cb75-5"><a href="#cb75-5"></a></span>
<span id="cb75-6"><a href="#cb75-6"></a>colors <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb75-7"><a href="#cb75-7"></a>  <span class="at">data =</span> <span class="st">"#41414550"</span>,</span>
<span id="cb75-8"><a href="#cb75-8"></a>  <span class="at">fit =</span> <span class="st">"#414145"</span>)</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="fu">ggplot</span>(points) <span class="sc">+</span> </span>
<span id="cb75-11"><a href="#cb75-11"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop) <span class="sc">+</span> </span>
<span id="cb75-12"><a href="#cb75-12"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> colors<span class="sc">$</span>data) <span class="sc">+</span></span>
<span id="cb75-13"><a href="#cb75-13"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb75-14"><a href="#cb75-14"></a>    <span class="at">name =</span> <span class="st">"Age in months"</span>, </span>
<span id="cb75-15"><a href="#cb75-15"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">96</span>), </span>
<span id="cb75-16"><a href="#cb75-16"></a>    <span class="co"># Because age is in months, I want breaks to land on multiples</span></span>
<span id="cb75-17"><a href="#cb75-17"></a>    <span class="co"># of 12. The `Q` in `extended_breaks()` are "nice" numbers to use</span></span>
<span id="cb75-18"><a href="#cb75-18"></a>    <span class="co"># for axis breaks.</span></span>
<span id="cb75-19"><a href="#cb75-19"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">Q =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">12</span>))) <span class="sc">+</span> </span>
<span id="cb75-20"><a href="#cb75-20"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb75-21"><a href="#cb75-21"></a>    <span class="at">name =</span> <span class="st">"Intelligibility"</span>,</span>
<span id="cb75-22"><a href="#cb75-22"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>),</span>
<span id="cb75-23"><a href="#cb75-23"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-53-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">96</span>, <span class="at">length.out =</span> <span class="dv">80</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="co"># Create the curve from the equation parameters</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>trend <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="at">age =</span> xs,</span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="at">asymptote =</span> .<span class="dv">8</span>,</span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="at">scale =</span> .<span class="dv">2</span>,</span>
<span id="cb76-8"><a href="#cb76-8"></a>  <span class="at">midpoint =</span> <span class="dv">48</span>,</span>
<span id="cb76-9"><a href="#cb76-9"></a>  <span class="at">prop =</span> asymptote <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((midpoint <span class="sc">-</span> age) <span class="sc">*</span> scale)))</span>
<span id="cb76-10"><a href="#cb76-10"></a></span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="fu">ggplot</span>(points) <span class="sc">+</span> </span>
<span id="cb76-12"><a href="#cb76-12"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop) <span class="sc">+</span> </span>
<span id="cb76-13"><a href="#cb76-13"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> trend, <span class="at">color =</span> colors<span class="sc">$</span>fit) <span class="sc">+</span></span>
<span id="cb76-14"><a href="#cb76-14"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> colors<span class="sc">$</span>data) <span class="sc">+</span></span>
<span id="cb76-15"><a href="#cb76-15"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb76-16"><a href="#cb76-16"></a>    <span class="at">name =</span> <span class="st">"Age in months"</span>, </span>
<span id="cb76-17"><a href="#cb76-17"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">96</span>), </span>
<span id="cb76-18"><a href="#cb76-18"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">Q =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">12</span>))) <span class="sc">+</span> </span>
<span id="cb76-19"><a href="#cb76-19"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb76-20"><a href="#cb76-20"></a>    <span class="at">name =</span> <span class="st">"Intelligibility"</span>,</span>
<span id="cb76-21"><a href="#cb76-21"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>),</span>
<span id="cb76-22"><a href="#cb76-22"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-54-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>colors<span class="sc">$</span>asym <span class="ot">&lt;-</span> <span class="st">"#E7552C"</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>colors<span class="sc">$</span>mid <span class="ot">&lt;-</span> <span class="st">"#3B7B9E"</span></span>
<span id="cb77-3"><a href="#cb77-3"></a>colors<span class="sc">$</span>scale <span class="ot">&lt;-</span> <span class="st">"#1FA35C"</span></span>
<span id="cb77-4"><a href="#cb77-4"></a></span>
<span id="cb77-5"><a href="#cb77-5"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(points) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> prop) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7"></a>  <span class="fu">annotate</span>(</span>
<span id="cb77-8"><a href="#cb77-8"></a>    <span class="st">"segment"</span>,</span>
<span id="cb77-9"><a href="#cb77-9"></a>    <span class="at">color =</span> colors<span class="sc">$</span>mid,</span>
<span id="cb77-10"><a href="#cb77-10"></a>    <span class="at">x =</span> <span class="dv">48</span>, <span class="at">xend =</span> <span class="dv">48</span>,</span>
<span id="cb77-11"><a href="#cb77-11"></a>    <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> .<span class="dv">4</span>,</span>
<span id="cb77-12"><a href="#cb77-12"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb77-13"><a href="#cb77-13"></a>  <span class="fu">annotate</span>(</span>
<span id="cb77-14"><a href="#cb77-14"></a>    <span class="st">"segment"</span>,</span>
<span id="cb77-15"><a href="#cb77-15"></a>    <span class="at">color =</span> colors<span class="sc">$</span>asym,</span>
<span id="cb77-16"><a href="#cb77-16"></a>    <span class="at">x =</span> <span class="dv">20</span>, <span class="at">xend =</span> <span class="cn">Inf</span>,</span>
<span id="cb77-17"><a href="#cb77-17"></a>    <span class="at">y =</span> .<span class="dv">8</span>, <span class="at">yend =</span> .<span class="dv">8</span>,</span>
<span id="cb77-18"><a href="#cb77-18"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb77-19"><a href="#cb77-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> trend, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> colors<span class="sc">$</span>fit) <span class="sc">+</span></span>
<span id="cb77-20"><a href="#cb77-20"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> colors<span class="sc">$</span>data) <span class="sc">+</span></span>
<span id="cb77-21"><a href="#cb77-21"></a>  <span class="fu">annotate</span>(</span>
<span id="cb77-22"><a href="#cb77-22"></a>    <span class="st">"text"</span>,</span>
<span id="cb77-23"><a href="#cb77-23"></a>    <span class="at">label =</span> <span class="st">"growth plateaus at asymptote"</span>,</span>
<span id="cb77-24"><a href="#cb77-24"></a>    <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> .<span class="dv">84</span>,</span>
<span id="cb77-25"><a href="#cb77-25"></a>    <span class="co"># horizontal justification = 0 sets x position to left edge of text</span></span>
<span id="cb77-26"><a href="#cb77-26"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb77-27"><a href="#cb77-27"></a>    <span class="at">color =</span> colors<span class="sc">$</span>asym) <span class="sc">+</span></span>
<span id="cb77-28"><a href="#cb77-28"></a>  <span class="fu">annotate</span>(</span>
<span id="cb77-29"><a href="#cb77-29"></a>    <span class="st">"text"</span>,</span>
<span id="cb77-30"><a href="#cb77-30"></a>    <span class="at">label =</span> <span class="st">"growth steepest at midpoint"</span>,</span>
<span id="cb77-31"><a href="#cb77-31"></a>    <span class="at">x =</span> <span class="dv">49</span>, <span class="at">y =</span> .<span class="dv">05</span>,</span>
<span id="cb77-32"><a href="#cb77-32"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb77-33"><a href="#cb77-33"></a>    <span class="at">color =</span> colors<span class="sc">$</span>mid) <span class="sc">+</span></span>
<span id="cb77-34"><a href="#cb77-34"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb77-35"><a href="#cb77-35"></a>    <span class="at">name =</span> <span class="st">"Age in months"</span>, </span>
<span id="cb77-36"><a href="#cb77-36"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">96</span>), </span>
<span id="cb77-37"><a href="#cb77-37"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">extended_breaks</span>(<span class="at">Q =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">12</span>))) <span class="sc">+</span> </span>
<span id="cb77-38"><a href="#cb77-38"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb77-39"><a href="#cb77-39"></a>    <span class="at">name =</span> <span class="st">"Intelligibility"</span>,</span>
<span id="cb77-40"><a href="#cb77-40"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>),</span>
<span id="cb77-41"><a href="#cb77-41"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>))</span>
<span id="cb77-42"><a href="#cb77-42"></a></span>
<span id="cb77-43"><a href="#cb77-43"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-55-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p><span class="math display">\[f(t) = \frac{\text{asymptote}}{1 + \exp{((\text{mid}~-~t)~*~\text{scale})}}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>annotate_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(label, ...) {</span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">6</span>, <span class="at">label =</span> label, <span class="at">parse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb78-3"><a href="#cb78-3"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, ...)</span>
<span id="cb78-4"><a href="#cb78-4"></a>}</span>
<span id="cb78-5"><a href="#cb78-5"></a></span>
<span id="cb78-6"><a href="#cb78-6"></a>slope <span class="ot">&lt;-</span> (.<span class="dv">2</span> <span class="sc">/</span> <span class="dv">4</span>) <span class="sc">*</span> .<span class="dv">8</span></span>
<span id="cb78-7"><a href="#cb78-7"></a>x_step <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb78-8"><a href="#cb78-8"></a>y1 <span class="ot">&lt;-</span> .<span class="dv">4</span> <span class="sc">+</span> slope <span class="sc">*</span> <span class="sc">-</span>x_step</span>
<span id="cb78-9"><a href="#cb78-9"></a>y2 <span class="ot">&lt;-</span> .<span class="dv">4</span> <span class="sc">+</span> slope <span class="sc">*</span> x_step</span>
<span id="cb78-10"><a href="#cb78-10"></a></span>
<span id="cb78-11"><a href="#cb78-11"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb78-12"><a href="#cb78-12"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb78-13"><a href="#cb78-13"></a>    <span class="at">x =</span> <span class="dv">48</span> <span class="sc">-</span> x_step, <span class="at">xend =</span> <span class="dv">48</span> <span class="sc">+</span> x_step,</span>
<span id="cb78-14"><a href="#cb78-14"></a>    <span class="at">y =</span> y1, <span class="at">yend =</span> y2,</span>
<span id="cb78-15"><a href="#cb78-15"></a>    <span class="at">size =</span> <span class="fl">1.2</span>,</span>
<span id="cb78-16"><a href="#cb78-16"></a>    <span class="at">color =</span> colors<span class="sc">$</span>scale,</span>
<span id="cb78-17"><a href="#cb78-17"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">1</span>, <span class="st">"in"</span>))) <span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18"></a>  <span class="fu">annotate</span>(</span>
<span id="cb78-19"><a href="#cb78-19"></a>    <span class="st">"text"</span>,</span>
<span id="cb78-20"><a href="#cb78-20"></a>    <span class="at">label =</span> <span class="st">"scale controls slope of curve"</span>,</span>
<span id="cb78-21"><a href="#cb78-21"></a>    <span class="at">x =</span> <span class="dv">49</span>, <span class="at">y =</span> .<span class="dv">38</span>, </span>
<span id="cb78-22"><a href="#cb78-22"></a>    <span class="at">color =</span> colors<span class="sc">$</span>scale, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb78-23"><a href="#cb78-23"></a></span>
<span id="cb78-24"><a href="#cb78-24"></a><span class="co"># p + annotate_eq(</span></span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="co">#     label = "f(t)==frac(asymptote, 1 + exp((mid-t)%*%scale))", </span></span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="co">#     color = colors$fit)</span></span>
<span id="cb78-27"><a href="#cb78-27"></a></span>
<span id="cb78-28"><a href="#cb78-28"></a>p1 <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb78-29"><a href="#cb78-29"></a>  <span class="fu">annotate_eq</span>(</span>
<span id="cb78-30"><a href="#cb78-30"></a>    <span class="at">label =</span> <span class="st">"</span></span>
<span id="cb78-31"><a href="#cb78-31"></a><span class="st">    f(t) == frac(</span></span>
<span id="cb78-32"><a href="#cb78-32"></a><span class="st">      phantom(asymptote), </span></span>
<span id="cb78-33"><a href="#cb78-33"></a><span class="st">      1 + exp((phantom(mid) - t) %*% phantom(scale))</span></span>
<span id="cb78-34"><a href="#cb78-34"></a><span class="st">    )"</span>,</span>
<span id="cb78-35"><a href="#cb78-35"></a>    <span class="at">color =</span> colors<span class="sc">$</span>fit) </span>
<span id="cb78-36"><a href="#cb78-36"></a></span>
<span id="cb78-37"><a href="#cb78-37"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb78-38"><a href="#cb78-38"></a>  <span class="fu">annotate_eq</span>(</span>
<span id="cb78-39"><a href="#cb78-39"></a>    <span class="at">label =</span> <span class="st">"</span></span>
<span id="cb78-40"><a href="#cb78-40"></a><span class="st">    phantom(f(t) == symbol('')) ~ atop(</span></span>
<span id="cb78-41"><a href="#cb78-41"></a><span class="st">      asymptote, </span></span>
<span id="cb78-42"><a href="#cb78-42"></a><span class="st">      phantom(1 + exp((mid-t) %*% scale))</span></span>
<span id="cb78-43"><a href="#cb78-43"></a><span class="st">    )"</span>,</span>
<span id="cb78-44"><a href="#cb78-44"></a>    <span class="at">color =</span> colors<span class="sc">$</span>asym)</span>
<span id="cb78-45"><a href="#cb78-45"></a></span>
<span id="cb78-46"><a href="#cb78-46"></a>p2 <span class="sc">+</span></span>
<span id="cb78-47"><a href="#cb78-47"></a>  <span class="fu">annotate_eq</span>(</span>
<span id="cb78-48"><a href="#cb78-48"></a>    <span class="at">label =</span> <span class="st">"</span></span>
<span id="cb78-49"><a href="#cb78-49"></a><span class="st">    phantom(f(t) == symbol('')) ~ atop(</span></span>
<span id="cb78-50"><a href="#cb78-50"></a><span class="st">      phantom(asymptote), </span></span>
<span id="cb78-51"><a href="#cb78-51"></a><span class="st">      phantom(1 + exp((mid-t) * symbol(''))) ~ scale</span></span>
<span id="cb78-52"><a href="#cb78-52"></a><span class="st">    )"</span>,</span>
<span id="cb78-53"><a href="#cb78-53"></a>    <span class="at">color =</span> colors<span class="sc">$</span>scale) <span class="sc">+</span></span>
<span id="cb78-54"><a href="#cb78-54"></a>  <span class="fu">annotate_eq</span>(</span>
<span id="cb78-55"><a href="#cb78-55"></a>    <span class="at">label =</span> <span class="st">"</span></span>
<span id="cb78-56"><a href="#cb78-56"></a><span class="st">    phantom(f(t) == symbol('')) ~ atop(</span></span>
<span id="cb78-57"><a href="#cb78-57"></a><span class="st">      phantom(asymptote), </span></span>
<span id="cb78-58"><a href="#cb78-58"></a><span class="st">      paste(</span></span>
<span id="cb78-59"><a href="#cb78-59"></a><span class="st">        phantom(paste(1 + exp, symbol(')'), symbol(')'))),</span></span>
<span id="cb78-60"><a href="#cb78-60"></a><span class="st">        mid,</span></span>
<span id="cb78-61"><a href="#cb78-61"></a><span class="st">        phantom(paste(symbol('-'), t, symbol(')') * scale))</span></span>
<span id="cb78-62"><a href="#cb78-62"></a><span class="st">      )</span></span>
<span id="cb78-63"><a href="#cb78-63"></a><span class="st">    )"</span>,</span>
<span id="cb78-64"><a href="#cb78-64"></a>    <span class="at">color =</span> colors<span class="sc">$</span>mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-56-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb79-2"><a href="#cb79-2"></a></span>
<span id="cb79-3"><a href="#cb79-3"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb79-4"><a href="#cb79-4"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="dv">45</span>, <span class="dv">52</span>, <span class="dv">61</span>, <span class="dv">80</span>, <span class="dv">74</span>), </span>
<span id="cb79-5"><a href="#cb79-5"></a>  <span class="at">prop =</span> <span class="fu">c</span>(<span class="fl">0.146</span>, <span class="fl">0.241</span>, <span class="fl">0.571</span>, <span class="fl">0.745</span>, <span class="fl">0.843</span>, <span class="fl">0.738</span>)</span>
<span id="cb79-6"><a href="#cb79-6"></a>)</span>
<span id="cb79-7"><a href="#cb79-7"></a></span>
<span id="cb79-8"><a href="#cb79-8"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb79-9"><a href="#cb79-9"></a></span>
<span id="cb79-10"><a href="#cb79-10"></a>model_formula <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb79-11"><a href="#cb79-11"></a>  <span class="co"># Logistic curve</span></span>
<span id="cb79-12"><a href="#cb79-12"></a>  prop <span class="sc">~</span> <span class="fu">inv_logit</span>(asymlogit) <span class="sc">*</span> <span class="fu">inv</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((mid <span class="sc">-</span> age) <span class="sc">*</span> <span class="fu">exp</span>(scale))),</span>
<span id="cb79-13"><a href="#cb79-13"></a>  <span class="co"># Each term in the logistic equation gets a linear model</span></span>
<span id="cb79-14"><a href="#cb79-14"></a>  asymlogit <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb79-15"><a href="#cb79-15"></a>  mid <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb79-16"><a href="#cb79-16"></a>  scale <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb79-17"><a href="#cb79-17"></a>  <span class="co"># Precision</span></span>
<span id="cb79-18"><a href="#cb79-18"></a>  phi <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb79-19"><a href="#cb79-19"></a>  <span class="co"># This is a nonlinear Beta regression model</span></span>
<span id="cb79-20"><a href="#cb79-20"></a>  <span class="at">nl =</span> <span class="cn">TRUE</span>, </span>
<span id="cb79-21"><a href="#cb79-21"></a>  <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> identity)</span>
<span id="cb79-22"><a href="#cb79-22"></a>)</span>
<span id="cb79-23"><a href="#cb79-23"></a></span>
<span id="cb79-24"><a href="#cb79-24"></a>prior_fixef <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-25"><a href="#cb79-25"></a>  <span class="co"># Point of steepest growth is age 4 plus/minus 2 years</span></span>
<span id="cb79-26"><a href="#cb79-26"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">48</span>, <span class="dv">12</span>), <span class="at">nlpar =</span> <span class="st">"mid"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb79-27"><a href="#cb79-27"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="fl">1.25</span>, .<span class="dv">75</span>), <span class="at">nlpar =</span> <span class="st">"asymlogit"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb79-28"><a href="#cb79-28"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>), <span class="at">nlpar =</span> <span class="st">"scale"</span>, <span class="at">coef =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb79-29"><a href="#cb79-29"></a>)</span>
<span id="cb79-30"><a href="#cb79-30"></a></span>
<span id="cb79-31"><a href="#cb79-31"></a>prior_phi <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-32"><a href="#cb79-32"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">dpar =</span> <span class="st">"phi"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb79-33"><a href="#cb79-33"></a>)</span>
<span id="cb79-34"><a href="#cb79-34"></a></span>
<span id="cb79-35"><a href="#cb79-35"></a>fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb79-36"><a href="#cb79-36"></a>  model_formula,</span>
<span id="cb79-37"><a href="#cb79-37"></a>  <span class="at">data =</span> data,</span>
<span id="cb79-38"><a href="#cb79-38"></a>  <span class="at">prior =</span> <span class="fu">c</span>(prior_fixef, prior_phi),</span>
<span id="cb79-39"><a href="#cb79-39"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb79-40"><a href="#cb79-40"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb79-41"><a href="#cb79-41"></a>  <span class="at">cores =</span> <span class="dv">1</span>,</span>
<span id="cb79-42"><a href="#cb79-42"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>), </span>
<span id="cb79-43"><a href="#cb79-43"></a>  <span class="at">seed =</span> <span class="dv">20211014</span>,</span>
<span id="cb79-44"><a href="#cb79-44"></a>  <span class="at">file =</span> <span class="st">"glm_growth_curve"</span>,</span>
<span id="cb79-45"><a href="#cb79-45"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb79-46"><a href="#cb79-46"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb79-47"><a href="#cb79-47"></a>)</span>
<span id="cb79-48"><a href="#cb79-48"></a></span>
<span id="cb79-49"><a href="#cb79-49"></a>draws_posterior <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb79-50"><a href="#cb79-50"></a>  tidyr<span class="sc">::</span><span class="fu">expand</span>(<span class="at">age =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-51"><a href="#cb79-51"></a>  tidybayes<span class="sc">::</span><span class="fu">add_epred_draws</span>(fit, <span class="at">ndraws =</span> <span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: beta 
  Links: mu = identity; phi = log 
Formula: prop ~ inv_logit(asymlogit) * inv(1 + exp((mid - age) * exp(scale))) 
         asymlogit ~ 1
         mid ~ 1
         scale ~ 1
         phi ~ 1
   Data: data (Number of observations: 6) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
phi_Intercept           2.99      0.73     1.53     4.36 1.00     1087     1678
asymlogit_Intercept     1.46      0.41     0.71     2.40 1.00     1819     1891
mid_Intercept          47.60      3.27    40.21    53.40 1.00     1544     1143
scale_Intercept        -1.96      0.40    -2.82    -1.22 1.00     1462     1591

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">ggplot</span>(draws_posterior) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> .epred) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4"></a> <span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb82-6"><a href="#cb82-6"></a>    <span class="fu">aes</span>(<span class="at">y =</span> prop), </span>
<span id="cb82-7"><a href="#cb82-7"></a>    <span class="at">data =</span> data</span>
<span id="cb82-8"><a href="#cb82-8"></a>  ) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-59-1.png" width="960" class="r-stretch"></section>
<section id="non-linear-models" class="slide level2">
<h2>Non-linear models</h2>
<p>Standard GLM can be written this way, which reflects a linear combination <span class="math display">\[ \eta_n = \sum_{i = 1}^K b_i x_{ni}\]</span></p>
<p>Nonlinear models cannot, such as: <span class="math display">\[\eta_n = b_1 \exp(b_2 x_n)\]</span></p>
<ul>
<li>Many nonlinear functions exist, and can be used in standard regression. We can of course take these functions and apply them to longitudinal data.</li>
</ul>
</section>
<section class="slide level2">

<p>Insurance example <span class="math display">\[ \mu_{AY, dev} = ult_{AY}
\left(1 - \exp\left(- \left( \frac{dev}{\theta} \right)^\omega \right)
\right)\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">data</span>(loss)</span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="fu">head</span>(loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    AY dev      cum premium
1 1991   6  357.848   10000
2 1991  18 1124.788   10000
3 1991  30 1735.330   10000
4 1991  42 2182.708   10000
5 1991  54 2745.596   10000
6 1991  66 3319.994   10000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>fit_loss <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">bf</span>(cum <span class="sc">~</span> ult <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>(dev<span class="sc">/</span>theta)<span class="sc">^</span>omega)),</span>
<span id="cb85-3"><a href="#cb85-3"></a>     ult <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>AY), omega <span class="sc">~</span> <span class="dv">1</span>, theta <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb85-4"><a href="#cb85-4"></a>     <span class="at">nl =</span> <span class="cn">TRUE</span>),</span>
<span id="cb85-5"><a href="#cb85-5"></a>  <span class="at">data =</span> loss, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb85-6"><a href="#cb85-6"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb85-7"><a href="#cb85-7"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">5000</span>, <span class="dv">1000</span>), <span class="at">nlpar =</span> <span class="st">"ult"</span>),</span>
<span id="cb85-8"><a href="#cb85-8"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">nlpar =</span> <span class="st">"omega"</span>),</span>
<span id="cb85-9"><a href="#cb85-9"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">45</span>, <span class="dv">10</span>), <span class="at">nlpar =</span> <span class="st">"theta"</span>)),</span>
<span id="cb85-10"><a href="#cb85-10"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.9</span>),</span>
<span id="cb85-11"><a href="#cb85-11"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb85-12"><a href="#cb85-12"></a>  <span class="at">file =</span> <span class="st">"loss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">conditional_effects</span>(fit_loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="bends-4_files/figure-revealjs/unnamed-chunk-62-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">summary</span>(fit_loss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: cum ~ ult * (1 - exp(-(dev/theta)^omega)) 
         ult ~ 1 + (1 | AY)
         omega ~ 1
         theta ~ 1
   Data: loss (Number of observations: 55) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~AY (Number of levels: 10) 
                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(ult_Intercept)   744.76    226.22   431.67  1324.21 1.01     1016     1645

Population-Level Effects: 
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ult_Intercept    5295.61    285.14  4734.32  5875.46 1.00      983     1309
omega_Intercept     1.34      0.05     1.24     1.43 1.00     2251     2279
theta_Intercept    46.14      2.06    42.60    50.65 1.00     2089     1902

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma   140.09     15.73   113.00   174.15 1.00     2258     2461

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Wright &amp; Jackson, 2022 JPSP asymptoptic growth curve example</p>
<p><span class="math display">\[Y_{ij}=\ a_j-\left(a_j-\ b_j\right)\ast e^{\left(-c_j{time}_{ij}\right)}\ \]</span> <span class="math display">\[b_j=\ \gamma_b0+\ U_bj\]</span> <span class="math display">\[c_j=\ \gamma_{c0}+\ U_{cj}\]</span> <span class="math inline">\(b_j\)</span> can be thought of as the intercept, whereas <span class="math inline">\(c_j\)</span> is the slope. <span class="math inline">\(a_j\)</span> is maximum possible value</p>
</section>
<section class="slide level2">


<img data-src="nonlinear.png" class="r-stretch"></section>
<section id="gams" class="slide level2">
<h2>GAMs</h2>
<ul>
<li><p>Standard longitudinal models are simple to understand (lines!), but fail to capture the ebbs and flows of many time series. Yet there are downsides to polynomial models, as they end up making bad predictions at the ends</p></li>
<li><p>We can do localized regression such as lowess but those are non-parameteric and thus we cannot do standard inferential tests on this</p></li>
<li><p>GAMs offer a middle ground: they can be fit to complex, nonlinear relationships and make good predictions in these cases, but we are still able to do inferential statistics and understand and explain the underlying structure of our models</p></li>
</ul>
</section>
<section id="generalized-additive-models" class="slide level2">
<h2>Generalized additive models</h2>
<p>Similar to going from general linear model to generalized linear model. One more generalization.</p>
<p><span class="math display">\[y \sim ExpoFam(\mu, etc.)\]</span> <span class="math display">\[E(y) = \mu\]</span></p>
<p><span class="math display">\[g(\mu) = b_0 + f(x_1) + f(x_2) \;...\;+f(x_p)\]</span></p>
<p>exponential family distribution, and μ is still related to the model predictors via a link function. The key difference is that the linear predictor now incorporates smooth functions of at least some (possibly all) features, represented as f(x), and this will allow for nonlinear relationships between the features and the target variable y.</p>
</section>
<section id="when-to-use" class="slide level2">
<h2>When to use?</h2>
<ul>
<li>Take a look at your scatter plots, are they monotononicly linear?</li>
<li>Residuals vs fitted look off? QQ plot looking bent?</li>
<li>Transformations help in general but make edge cases even worse?</li>
<li>Polynomial not cutting it</li>
<li>You want to be as flexible as possible</li>
</ul>
</section>
<section id="simplified-gam" class="slide level2">
<h2>Simplified GAM</h2>
<p><span class="math display">\[y = f(x) + \epsilon\]</span></p>
<p>choosing a basis, which in technical terms means choosing a space of functions for which (f) is some element of it.</p>
<p><span class="math display">\[y = f(x) + \epsilon = \sum_{j=1}^{d}F_j(x)\beta_j + \epsilon\]</span> Above, each Fj is a basis function that is the transformed x depending on the type of basis considered, and the b are the corresponding regression coefficients.</p>
</section>
<section class="slide level2">

<p>Can think of the basis function as a polynomial with d = 2 (but it could be many other things too) <span class="math display">\[y = f(x) + \epsilon = \sum_{j=1}^{d}F_j(x)\beta_j + \epsilon\]</span></p>
<p><span class="math display">\[f(x) = b_0 + b_1\cdot x^1 \ldots +b_d\cdot x^d\]</span> These basis functions become extra variables used to predict, though each of them are often “hidden” behind the overly bland “basis function”</p>
</section>
<section id="penalized-estimation" class="slide level2">
<h2>Penalized estimation</h2>
<ul>
<li><p>One concern is that we overfit our data and make our lines too wiggly. We can overcome this via penalized estimation, basically balancing minimizing residuals with out of sample prediction.</p></li>
<li><p>This is what is used in lasso or ridge regression or many other machine learning algorithms.</p></li>
<li><p>A penalization parameter often called lambda uses cross validation to balance over vs under fitting</p></li>
</ul>
</section>
<section id="knots-and-basis-function" class="slide level2">
<h2>Knots and basis function</h2>
<ul>
<li><p>The major decision points are 1) the number of knots we want to use (similar to piecewise models) and 2) the basis function.</p></li>
<li><p>A simple basis function is to use a cubic polynomial, but the default of many packages are penalized thin plate regression splines, which work quite well.</p></li>
</ul>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>